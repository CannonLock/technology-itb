



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
  <meta name="robots" content="noindex, nofollow" />

      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://opensciencegrid.github.io/technology-itb/infrastructure/madison-itb/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.1, mkdocs-material-2.6.0">
    
    
      
        <title>Madison ITB - OSG Technology Area (ITB)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.aa3de92b.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/itb.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#softwarerelease-team-itb-site-design" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://opensciencegrid.github.io/technology-itb/" title="OSG Technology Area (ITB)" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                OSG Technology Area (ITB)
              </span>
              <span class="md-header-nav__topic">
                Madison ITB
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/opensciencegrid/technology-itb/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    OSG Technology Area (ITB)
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/opensciencegrid/technology-itb/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Software
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Software
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Packaging
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Packaging
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/rpm-development-guide/" title="RPM Development Guide" class="md-nav__link">
      RPM Development Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/osg-build-tools/" title="OSG Build Tools" class="md-nav__link">
      OSG Build Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/quilt/" title="Using Quilt" class="md-nav__link">
      Using Quilt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/upcoming-to-main/" title="Upcoming to Main" class="md-nav__link">
      Upcoming to Main
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/koji-workflow/" title="Koji Workflow" class="md-nav__link">
      Koji Workflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/create-vo-client/" title="Creating the VO Client Package" class="md-nav__link">
      Creating the VO Client Package
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/repository-management/" title="Repository Management" class="md-nav__link">
      Repository Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/globus-mass-update-procedure/" title="Globus Mass Update Procedure" class="md-nav__link">
      Globus Mass Update Procedure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/resurrecting-epel-packages/" title="Resurrecting Epel Packages" class="md-nav__link">
      Resurrecting Epel Packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/koji-mass-rebuilds/" title="Koji Mass Rebuilds" class="md-nav__link">
      Koji Mass Rebuilds
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/development-process/" title="Development Process" class="md-nav__link">
      Development Process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/git-software-development/" title="Git Software Development Process" class="md-nav__link">
      Git Software Development Process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/ce-test-scaling/" title="CE Scale Testing" class="md-nav__link">
      CE Scale Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/pki-overview/" title="PKI Overview" class="md-nav__link">
      PKI Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/ipv6-testing/" title="IPv6 Testing" class="md-nav__link">
      IPv6 Testing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/software-support/" title="Software Support" class="md-nav__link">
      Software Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/effort-tracking/" title="Effort Tracking" class="md-nav__link">
      Effort Tracking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/release-planning/" title="Release Planning" class="md-nav__link">
      Release Planning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../software/new-team-member/" title="New Team Member" class="md-nav__link">
      New Team Member
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Release
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Release
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/cut-sw-release/" title="How to Cut a Release" class="md-nav__link">
      How to Cut a Release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/cut-data-release/" title="How to Cut a Data Release" class="md-nav__link">
      How to Cut a Data Release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/release-policy/" title="Release Policy" class="md-nav__link">
      Release Policy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/release-schedule/" title="Release Schedule" class="md-nav__link">
      Release Schedule
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/new-release-series/" title="New Release Series" class="md-nav__link">
      New Release Series
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/old-release-removal/" title="Old Release Series Removal" class="md-nav__link">
      Old Release Series Removal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/itb-testing/" title="ITB Prerelease Testing" class="md-nav__link">
      ITB Prerelease Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/empty-pkgs/" title="Empty Packages" class="md-nav__link">
      Empty Packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/acceptance-testing/" title="Acceptance Testing" class="md-nav__link">
      Acceptance Testing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Policy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Policy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/gums-retire/" title="GUMS Retirement" class="md-nav__link">
      GUMS Retirement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/bestman2-retire/" title="BeStMan2 Retirement" class="md-nav__link">
      BeStMan2 Retirement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/voms-admin-retire/" title="VOMS Admin Retirement" class="md-nav__link">
      VOMS Admin Retirement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/release-series/" title="Release Series Support" class="md-nav__link">
      Release Series Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/globus-toolkit/" title="Globus Toolkit Support" class="md-nav__link">
      Globus Toolkit Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/external-oasis-repos/" title="OASIS Repository Mirroring" class="md-nav__link">
      OASIS Repository Mirroring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/flexible-release-model/" title="Flexible Release Model" class="md-nav__link">
      Flexible Release Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Infrastructure
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Infrastructure
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../koji-restore-recipe/" title="Koji Restore Recipe" class="md-nav__link">
      Koji Restore Recipe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../koji-hub-setup/" title="Koji-Hub Setup" class="md-nav__link">
      Koji-Hub Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../koji-inf-overview/" title="Koji Infrastructure Overview" class="md-nav__link">
      Koji Infrastructure Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../koji-policy-writing/" title="Koji Policy Writing" class="md-nav__link">
      Koji Policy Writing
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Madison ITB
      </label>
    
    <a href="./" title="Madison ITB" class="md-nav__link md-nav__link--active">
      Madison ITB
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#madison-itb-machines" title="Madison ITB Machines" class="md-nav__link">
    Madison ITB Machines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#itb-goals" title="ITB Goals" class="md-nav__link">
    ITB Goals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" title="Configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git-repository" title="Git Repository" class="md-nav__link">
    Git Repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible" title="Ansible" class="md-nav__link">
    Ansible
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-ansible-commands" title="Common Ansible commands" class="md-nav__link">
    Common Ansible commands
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-host-and-other-certificates" title="Adding host and other certificates" class="md-nav__link">
    Adding host and other certificates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#doing-yum-updates" title="Doing yum updates" class="md-nav__link">
    Doing yum updates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-htcondor-from-upcoming" title="Updating HTCondor from Upcoming" class="md-nav__link">
    Updating HTCondor from Upcoming
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring" title="Monitoring" class="md-nav__link">
    Monitoring
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#htcondor-ce-view" title="HTCondor-CE View" class="md-nav__link">
    HTCondor-CE View
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracking-payload-jobs-via-kibana" title="Tracking payload jobs via Kibana" class="md-nav__link">
    Tracking payload jobs via Kibana
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-a-new-virtual-machine-on-itb-host-1" title="Making a New Virtual Machine on itb-host-1" class="md-nav__link">
    Making a New Virtual Machine on itb-host-1
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libvirt-vm-template" title="Libvirt VM Template" class="md-nav__link">
    Libvirt VM Template
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/writing-documentation/" title="Writing Documentation" class="md-nav__link">
      Writing Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/reviewing-documentation/" title="Reviewing Documentation" class="md-nav__link">
      Reviewing Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/style-guide/" title="Markdown Style Guide" class="md-nav__link">
      Markdown Style Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/new-doc-area/" title="Creating a New Area" class="md-nav__link">
      Creating a New Area
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/markdown-migration/" title="Migrating Documents to Markdown" class="md-nav__link">
      Migrating Documents to Markdown
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Historical Information
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Historical Information
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../koji-initial-install/" title="Koji Initial Install" class="md-nav__link">
      Koji Initial Install
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Historical Transitions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Historical Transitions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/sha2-support/" title="SHA-2 Support" class="md-nav__link">
      SHA-2 Support
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Meetings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Meetings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2018/TechArea20180205/" title="February 5, 2018" class="md-nav__link">
      February 5, 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2018/TechArea20180129/" title="January 29, 2018" class="md-nav__link">
      January 29, 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2018/TechArea20180122/" title="January 22, 2018" class="md-nav__link">
      January 22, 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2018/TechArea20180108/" title="January 8, 2018" class="md-nav__link">
      January 8, 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2018/TechArea20180102/" title="January 2, 2018" class="md-nav__link">
      January 2, 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171218/" title="December 18, 2017" class="md-nav__link">
      December 18, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171211/" title="December 11, 2017" class="md-nav__link">
      December 11, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171204/" title="December 4, 2017" class="md-nav__link">
      December 4, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171127/" title="November 27, 2017" class="md-nav__link">
      November 27, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171120/" title="November 20, 2017" class="md-nav__link">
      November 20, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171113/" title="November 13, 2017" class="md-nav__link">
      November 13, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171106/" title="November 6, 2017" class="md-nav__link">
      November 6, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171030/" title="October 30, 2017" class="md-nav__link">
      October 30, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171023/" title="October 23, 2017" class="md-nav__link">
      October 23, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171016/" title="October 16, 2017" class="md-nav__link">
      October 16, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171009/" title="October 9, 2017" class="md-nav__link">
      October 9, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20171002/" title="October 2, 2017" class="md-nav__link">
      October 2, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170925/" title="September 25, 2017" class="md-nav__link">
      September 25, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170918/" title="September 18, 2017" class="md-nav__link">
      September 18, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170911/" title="September 11, 2017" class="md-nav__link">
      September 11, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170905/" title="September 5, 2017" class="md-nav__link">
      September 5, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170828/" title="August 28, 2017" class="md-nav__link">
      August 28, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170814/" title="August 14, 2017" class="md-nav__link">
      August 14, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170807/" title="August 7, 2017" class="md-nav__link">
      August 7, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170731/" title="July 31, 2017" class="md-nav__link">
      July 31, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170724/" title="July 24, 2017" class="md-nav__link">
      July 24, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170717/" title="July 17, 2017" class="md-nav__link">
      July 17, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170710/" title="July 10, 2017" class="md-nav__link">
      July 10, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170703/" title="July 3, 2017" class="md-nav__link">
      July 3, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170626/" title="June 26, 2017" class="md-nav__link">
      June 26, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170619/" title="June 19, 2017" class="md-nav__link">
      June 19, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170612/" title="June 12, 2017" class="md-nav__link">
      June 12, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170605/" title="June 6, 2017" class="md-nav__link">
      June 6, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170530/" title="May 30, 2017" class="md-nav__link">
      May 30, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170522/" title="May 22, 2017" class="md-nav__link">
      May 22, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170515/" title="May 15, 2017" class="md-nav__link">
      May 15, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170508/" title="May 8, 2017" class="md-nav__link">
      May 8, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170501/" title="May 1, 2017" class="md-nav__link">
      May 1, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170424/" title="April 24, 2017" class="md-nav__link">
      April 24, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170417/" title="April 17, 2017" class="md-nav__link">
      April 17, 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2017/TechArea20170227/" title="February 27, 2017" class="md-nav__link">
      February 27, 2017
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#madison-itb-machines" title="Madison ITB Machines" class="md-nav__link">
    Madison ITB Machines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#itb-goals" title="ITB Goals" class="md-nav__link">
    ITB Goals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" title="Configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git-repository" title="Git Repository" class="md-nav__link">
    Git Repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible" title="Ansible" class="md-nav__link">
    Ansible
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-ansible-commands" title="Common Ansible commands" class="md-nav__link">
    Common Ansible commands
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-host-and-other-certificates" title="Adding host and other certificates" class="md-nav__link">
    Adding host and other certificates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#doing-yum-updates" title="Doing yum updates" class="md-nav__link">
    Doing yum updates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-htcondor-from-upcoming" title="Updating HTCondor from Upcoming" class="md-nav__link">
    Updating HTCondor from Upcoming
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring" title="Monitoring" class="md-nav__link">
    Monitoring
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#htcondor-ce-view" title="HTCondor-CE View" class="md-nav__link">
    HTCondor-CE View
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracking-payload-jobs-via-kibana" title="Tracking payload jobs via Kibana" class="md-nav__link">
    Tracking payload jobs via Kibana
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-a-new-virtual-machine-on-itb-host-1" title="Making a New Virtual Machine on itb-host-1" class="md-nav__link">
    Making a New Virtual Machine on itb-host-1
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libvirt-vm-template" title="Libvirt VM Template" class="md-nav__link">
    Libvirt VM Template
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/opensciencegrid/technology-itb/edit/master/docs/infrastructure/madison-itb.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <style type="text/css">
pre em { color: red; font-weight: normal; font-style: normal; }
.old { color: red; }
.off { color: blue; }
</style>

<h1 id="softwarerelease-team-itb-site-design">Software/Release Team ITB Site Design<a class="headerlink" href="#softwarerelease-team-itb-site-design" title="Permanent link">&para;</a></h1>
<h2 id="madison-itb-machines">Madison ITB Machines<a class="headerlink" href="#madison-itb-machines" title="Permanent link">&para;</a></h2>
<p>All physical hosts are located in 3370A in the VDT rack.</p>
<table>
<thead>
<tr>
<th align="left">Host</th>
<th align="left">Purpose</th>
<th align="left">OS</th>
<th align="left">CPU Model</th>
<th align="left">CPUs</th>
<th align="left">RAM</th>
<th align="left">Storage</th>
<th align="left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">itb-data1</td>
<td align="left">worker node</td>
<td align="left">SL 6.9</td>
<td align="left">Celeron G530 2.4Ghz</td>
<td align="left">2 / 2</td>
<td align="left">8 GB</td>
<td align="left">750 GB × 2 (RAID?)</td>
<td align="left">planned as HDFS data node</td>
</tr>
<tr>
<td align="left">itb-data2</td>
<td align="left">worker node</td>
<td align="left">SL 6.9</td>
<td align="left">Celeron G530 2.4Ghz</td>
<td align="left">2 / 2</td>
<td align="left">8 GB</td>
<td align="left">750 GB × 2 (RAID?)</td>
<td align="left">planned as HDFS data node</td>
</tr>
<tr>
<td align="left">itb-data3</td>
<td align="left">worker node</td>
<td align="left">SL 7.4</td>
<td align="left">Celeron G530 2.4Ghz</td>
<td align="left">2 / 2</td>
<td align="left">8 GB</td>
<td align="left">750 GB × 2 (RAID?)</td>
<td align="left">planned as HDFS data node</td>
</tr>
<tr>
<td align="left">itb-data4</td>
<td align="left">worker node</td>
<td align="left">SL 6.9</td>
<td align="left">Celeron G530 2.4Ghz</td>
<td align="left">2 / 2</td>
<td align="left">8 GB</td>
<td align="left">750 GB × 2 (RAID?)</td>
<td align="left">planned as XRootD data node</td>
</tr>
<tr>
<td align="left">itb-data5</td>
<td align="left">worker node</td>
<td align="left">SL 6.9</td>
<td align="left">Xeon E3-1220 3.10GHz</td>
<td align="left">2 / 4</td>
<td align="left">8 GB</td>
<td align="left">750 GB × 2 (RAID?)</td>
<td align="left">planned as XRootD data node</td>
</tr>
<tr>
<td align="left">itb-data6</td>
<td align="left">worker node</td>
<td align="left">SL 7.4</td>
<td align="left">Xeon E3-1220 3.10GHz</td>
<td align="left">2 / 4</td>
<td align="left">8 GB</td>
<td align="left">???</td>
<td align="left">planned as XRootD data node</td>
</tr>
<tr>
<td align="left">itb-host-1</td>
<td align="left">KVM host</td>
<td align="left">SL 7.4</td>
<td align="left">Xeon E5-2450 2.10GHz</td>
<td align="left">16 / 32</td>
<td align="left">64 GB</td>
<td align="left">1 TB × 4 (HW RAID 5)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  itb-ce1</td>
<td align="left">HTCondor-CE</td>
<td align="left">SL 6.9</td>
<td align="left">VM</td>
<td align="left">4</td>
<td align="left">6 GB</td>
<td align="left">192 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  itb-ce2</td>
<td align="left">HTCondor-CE</td>
<td align="left">SL 6.9</td>
<td align="left">VM</td>
<td align="left">4</td>
<td align="left">6 GB</td>
<td align="left">192 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  itb-cm</td>
<td align="left">HTCondor CM</td>
<td align="left">SL 7.4</td>
<td align="left">VM</td>
<td align="left">4</td>
<td align="left">6 GB</td>
<td align="left">192 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  <span class="old">itb-glidein</span></td>
<td align="left">GlideinWMS VO frontend?</td>
<td align="left">SL 6.3</td>
<td align="left">VM</td>
<td align="left">3</td>
<td align="left">6 GB</td>
<td align="left">50 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  <span class="old">itb-gums-rsv</span></td>
<td align="left">GUMS, RSV</td>
<td align="left">SL 6.3</td>
<td align="left">VM</td>
<td align="left">3</td>
<td align="left">6 GB</td>
<td align="left">50 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  <span class="off">itb-hdfs-name1</span></td>
<td align="left">— (so far)</td>
<td align="left">SL ?</td>
<td align="left">VM</td>
<td align="left">4</td>
<td align="left">6 GB</td>
<td align="left">192 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  <span class="old">itb-hdfs-name2</span></td>
<td align="left">— (so far)</td>
<td align="left">SL 6.3</td>
<td align="left">VM</td>
<td align="left">3</td>
<td align="left">6 GB</td>
<td align="left">50 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  <span class="old">itb-se-hdfs</span></td>
<td align="left">— (so far)</td>
<td align="left">SL 6.3</td>
<td align="left">VM</td>
<td align="left">3</td>
<td align="left">6 GB</td>
<td align="left">50 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  <span class="old">itb-se-xrootd</span></td>
<td align="left">— (so far)</td>
<td align="left">SL 6.3</td>
<td align="left">VM</td>
<td align="left">3</td>
<td align="left">6 GB</td>
<td align="left">50 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  itb-submit</td>
<td align="left">HTCondor submit</td>
<td align="left">SL 6.9</td>
<td align="left">VM</td>
<td align="left">4</td>
<td align="left">6 GB</td>
<td align="left">192 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">·  <span class="off">itb-xrootd</span></td>
<td align="left">— (so far)</td>
<td align="left">SL ?</td>
<td align="left">VM</td>
<td align="left">4</td>
<td align="left">6 GB</td>
<td align="left">192 GB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">itb-host-2</td>
<td align="left">worker node</td>
<td align="left">SL 6.9</td>
<td align="left">Xeon E5-2450 2.10GHz</td>
<td align="left">16 / 32</td>
<td align="left">64 GB</td>
<td align="left">352 GB in $(EXECUTE)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">itb-host-3</td>
<td align="left">worker node</td>
<td align="left">SL 7.4</td>
<td align="left">Xeon E5-2450 2.10GHz</td>
<td align="left">16 / 32</td>
<td align="left">64 GB</td>
<td align="left">352 GB in $(EXECUTE)</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>(Data last updated 2017-10-13 by Tim C. <span class="old">Red</span> indicates a host that has yet to be rebuilt; <span class="off">Blue</span> is rebuilt but currently off.)</p>
<h2 id="itb-goals">ITB Goals<a class="headerlink" href="#itb-goals" title="Permanent link">&para;</a></h2>
<p>Goals for the Madison ITB site are now maintained in <a href="https://docs.google.com/document/d/1H4r8d2cznTKwnvPZGhj63-c7HMF9c_7izeU8dxerPiM/">a Google document</a>.</p>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p>Basic host configuration is handled by Ansible and a local Git repository of playbooks.</p>
<h3 id="git-repository">Git Repository<a class="headerlink" href="#git-repository" title="Permanent link">&para;</a></h3>
<p>The authoritative Git repository for Madison ITB configuration is <code>gitolite@git.chtc.wisc.edu:osgitb</code>.  Clone the
repository and push validated changes back to it.</p>
<h3 id="ansible">Ansible<a class="headerlink" href="#ansible" title="Permanent link">&para;</a></h3>
<p>The <code>osghost</code> machine has Ansible 2.3.1.0 installed via RPM.  Use other hosts and versions at your own risk.</p>
<h4 id="common-ansible-commands">Common Ansible commands<a class="headerlink" href="#common-ansible-commands" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong></p>
<ul>
<li>For critical passwords, see Tim C. or other knowledgeable Madison OSG staff in person</li>
<li>All commands below are meant to be run from the <code>osgitb</code> directory from Git</li>
</ul>
<p>To run Ansible for the first time on a new machine (using the <code>root</code> password when prompted):</p>
<div class="codehilite"><pre><span></span><span class="go">ansible-playbook secure.yml -i inventory -u root -k --ask-vault-pass -f 20 -l HOST-PATTERN</span>
<span class="go">ansible-playbook site.yml -i inventory -u root -k -f 20 -l HOST-PATTERN</span>
</pre></div>


<p>The <code>HOST-PATTERN</code> can be a glob-like pattern or a regular expression that matches host names in the inventory file; see
Ansible documentation for details.</p>
<p>After initial successful runs of both playbooks, subsequent runs should replace the <code>-u root -k</code> part with <code>-bK</code> to use
your own login and <code>sudo</code>.  For example:</p>
<div class="codehilite"><pre><span></span><span class="go">ansible-playbook secure.yml -i inventory -bK --ask-vault-pass -f 20 -l HOST-PATTERN</span>
<span class="go">ansible-playbook site.yml -i inventory -bK -f 20 [ -l HOST-PATTERN ]</span>
</pre></div>


<p>Omit the <code>-l</code> option to apply configuration to all hosts.</p>
<p>If you have your own playbook to manage personal configuration, run it as follows:</p>
<div class="codehilite"><pre><span></span><span class="go">ansible-playbook PLAYBOOK-PATH -i inventory -f 20 [ -l HOST-PATTERN ]</span>
</pre></div>


<h4 id="adding-host-and-other-certificates">Adding host and other certificates<a class="headerlink" href="#adding-host-and-other-certificates" title="Permanent link">&para;</a></h4>
<p>(This is in very rough form, but the key bits are here.)</p>
<ol>
<li>Ask Mat to get new certificates — be sure to think about <code>http</code>, <code>rsv</code>, and other service certificates</li>
<li>Wait for Mat to tell you that the new certificates are in <code>/p/condor/home/certificates</code></li>
<li><code>scp -p</code> the certificate(s) (<code>*cert.pem*</code> and <code>*key.pem</code>) to your home directory on <code>osghost</code> or whatever machine you use for Ansible</li>
<li>Find the corresponding certificate location(s) in the Ansible <code>roles/certs/files</code> directory</li>
<li><code>cp -p</code> the certificate files over the top of the existing Ansible ones (or create new, equivalent paths)</li>
<li>Run <code>ansible-vault encrypt FILE(S)</code> to encrypt the files — get the Ansible vault password from Tim C. if you need it</li>
<li>Verify permissions, contents (you can <code>cat</code> the encrypted files), etc.</li>
<li>Apply the files with something like <code>ansible-playbook secure.yml -i inventory -bK -f 20 -t certs</code></li>
<li>Commit changes (now or after applying)</li>
<li>Push changes to origin</li>
</ol>
<h4 id="doing-yum-updates">Doing yum updates<a class="headerlink" href="#doing-yum-updates" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>Check to see if updates are needed and, if so, what would be updated:</p>
<div class="codehilite"><pre><span></span><span class="go">ansible [ HOST | GROUP ] -i inventory -bK -f 20 -m command -a &#39;yum check-update&#39;</span>
</pre></div>


<p>You can name a single <code>HOST</code> or an inventory <code>GROUP</code> (such as the handy <code>current</code> group); with a group, you can
further restrict the hosts with a <code>-l</code> option.</p>
<p><strong>Note:</strong> <code>yum check-update</code> exits with status code <code>100</code> when it succeeds in identifying packages to update;
therefore Ansible shows such results as failures.</p>
</li>
<li>
<p>Review the package lists to be updated and decide whether to proceed with all updates or limited ones</p>
</li>
<li>
<p>Do updates:</p>
<div class="codehilite"><pre><span></span><span class="go">ansible [ HOST | GROUP ] -i inventory -bK -f 20 -m command -a &#39;yum --assumeyes update&#39; [ -l LIMITS ]</span>
</pre></div>


</li>
<li>
<p>If needed (and if unsure, ask a sysadmin), reboot machines:</p>
<div class="codehilite"><pre><span></span><span class="go">ansible [ HOST | GROUP ] -i inventory -bK -f 20 -m command -a &#39;/sbin/shutdown -r +1&#39; [ -l LIMITS ]</span>
</pre></div>


</li>
</ol>
<h4 id="updating-htcondor-from-upcoming">Updating HTCondor from Upcoming<a class="headerlink" href="#updating-htcondor-from-upcoming" title="Permanent link">&para;</a></h4>
<p>Something like this:</p>
<div class="codehilite"><pre><span></span><span class="go">ansible condordev -i inventory -bK -f 10 -m command -a &#39;yum --enablerepo=osg-upcoming --assumeyes update condor&#39;</span>
</pre></div>


<h2 id="monitoring">Monitoring<a class="headerlink" href="#monitoring" title="Permanent link">&para;</a></h2>
<h3 id="htcondor-ce-view">HTCondor-CE View<a class="headerlink" href="#htcondor-ce-view" title="Permanent link">&para;</a></h3>
<p>Once we sort out our firewall rules, pilot, VO, and schedd availability graphs should be available
<a href="http://itb-ce1.chtc.wisc.edu:59619">here</a> through HTCondor-CE View.</p>
<h3 id="tracking-payload-jobs-via-kibana">Tracking payload jobs via Kibana<a class="headerlink" href="#tracking-payload-jobs-via-kibana" title="Permanent link">&para;</a></h3>
<p>At this time, the easest way to verify that payload jobs are running within the glideinWMS pilots is to track their records via <a href="https://gracc.opensciencegrid.org/kibana/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:f,value:0),time:(from:now%2Fw,mode:quick,to:now%2Fw))&_a=(columns:!(_source),index:%27gracc.osg-itb.raw-\*%27,interval:auto,query:(query_string:(analyze_wildcard:!f,query:%27\*%27)),sort:!(EndTime,desc))">Kibana</a>. To view all payload jobs that have run on our ITB site in the past week, use <a href="https://gracc.opensciencegrid.org/kibana/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:f,value:0),time:(from:now%2Fw,mode:quick,to:now%2Fw))&_a=(columns:!(ProbeName),index:%27gracc.osg-itb.raw-\*%27,interval:auto,query:(query_string:(analyze_wildcard:!f,query:%27ResourceType:%20Payload%20AND%20ProbeConfig:%20%22condor:itb-ce1.chtc.wisc.edu%22%27)),sort:!(EndTime,desc))">this query</a>.</p>
<h2 id="making-a-new-virtual-machine-on-itb-host-1">Making a New Virtual Machine on itb-host-1<a class="headerlink" href="#making-a-new-virtual-machine-on-itb-host-1" title="Permanent link">&para;</a></h2>
<p>For this procedure, you will need login access to the CHTC Cobbler website, which is separate from other CHTC logins.
If you do not have an account, request one from the CHTC system administrators.</p>
<ol>
<li>
<p>If this is a new host (combination of MAC address, IP address, and hostname), set up host with CHTC Infrastructure</p>
<ol>
<li>Pick a MAC address, starting with <code>00:16:3e:</code> followed by three random octets (e.g., <code>00:16:3e:f7:29:ee</code>)</li>
<li>Email <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#104;&#116;&#99;&#111;&#110;&#100;&#111;&#114;&#45;&#105;&#110;&#102;&#64;&#99;&#115;&#46;&#119;&#105;&#115;&#99;&#46;&#101;&#100;&#117;">&#104;&#116;&#99;&#111;&#110;&#100;&#111;&#114;&#45;&#105;&#110;&#102;&#64;&#99;&#115;&#46;&#119;&#105;&#115;&#99;&#46;&#101;&#100;&#117;</a> with a request for a new OSG ITB VM, including the chosen MAC address</li>
<li>Wait to receive the associated IP address for the new host</li>
</ol>
</li>
<li>
<p>Create or edit the Cobbler system object for the host</p>
<ol>
<li>Access <a href="https://cobbler-widmir.chtc.wisc.edu/cobbler_web">https://cobbler-widmir.chtc.wisc.edu/cobbler_web</a></li>
<li>In the left navigation area, under “Configuration”, click the “Systems” link</li>
<li>If desired, filter (at the bottom) by “name” on something like <code>itb-*.chtc.wisc.edu</code></li>
<li>For a new host, select an existing, similar one and click “Copy” to the right of its entry, then give it a name and click “OK”</li>
<li>For a newly copied or any existing host, click “Edit” to the right of its entry</li>
<li>In the <strong>first</strong> “General” section: select a “Profile” of “Scientific_6_8_osg_vm” or “Scientific_7_2_osg_vm”</li>
<li>In the <strong>second</strong> “General” section, check the “Netboot Enabled” checkbox</li>
<li>In the “Networking (Global)” section, set “Hostname” to the fully qualified hostname for the virtual machine</li>
<li>In the “Networking” section, select the “eth0” interface to edit, and set the “MAC Address”, “IP Address”, and “DNS Name” fields for the host</li>
<li>Click the “Save” button</li>
<li>In the left navigation area, under “Actions”, click the “Sync” link</li>
</ol>
</li>
<li>
<p>Log in to <code>itb-host-1</code> and become <code>root</code></p>
</li>
<li>
<p>Create the libvirt definition file</p>
<ol>
<li>Create a new XML file named after the desired hostname (e.g., <code>itb-ce2.xml</code>) and copy in the template below</li>
<li>Replace <code>{{ HOSTNAME }}</code> with the fully qualified hostname of the new virtual host</li>
<li>Replace <code>{{ MAC_ADDRESS }}</code> with the MAC address of the new virtual host (from above)</li>
<li>If desired, edit other values in the XML definition file; ask CHTC Infrastructure for help, if needed</li>
<li>Save the XML file</li>
<li>
<p>Create a new, empty disk image for the virtual host, in its correct location (as specified in the XML file):</p>
<div class="codehilite"><pre><span></span><span class="go">truncate -s 192G /var/lib/libvirt/images/HOSTNAME.dd</span>
<span class="go">chown qemu:qemu /var/lib/libvirt/images/HOSTNAME.dd</span>
</pre></div>


</li>
<li>
<p>Load the new host definition into libvirt:</p>
<div class="codehilite"><pre><span></span><span class="go">virsh define XML-FILE</span>
</pre></div>


</li>
</ol>
</li>
<li>
<p>Install the new machine</p>
<ol>
<li>
<p>Start the virtual machine:</p>
<div class="codehilite"><pre><span></span><span class="go">virsh start HOSTNAME</span>
</pre></div>


<p>At this time, the machine will boot over the network, and Cobbler will install and minimally configure the OS,
then reboot the now-installed machine.  The whole process typically takes 15–20 minutes.  You may be able to
<code>ssh</code> into the machine during the install process, but there is no need to monitor or interfere.</p>
</li>
<li>
<p>Once the machine is available (which you can only guess at), <code>ssh</code> in and verify that the machine basically works</p>
</li>
<li>Immediately run Ansible on the machine, first with the <code>secure.yml</code> playbook, then the <code>site.yml</code> one (see above)</li>
<li>Log in to the machine and look around to make sure it seems OK</li>
<li>When things look good, tell virsh to start the virtual machine when the host itself starts:<div class="codehilite"><pre><span></span><span class="go">virsh autostart HOSTNAME</span>
</pre></div>


</li>
</ol>
</li>
</ol>
<h3 id="libvirt-vm-template">Libvirt VM Template<a class="headerlink" href="#libvirt-vm-template" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="nt">&lt;domain</span> <span class="na">type=</span><span class="s">&#39;kvm&#39;</span><span class="nt">&gt;</span>

  <span class="nt">&lt;name&gt;</span>{{ HOSTNAME }}<span class="nt">&lt;/name&gt;</span>

  <span class="nt">&lt;memory</span> <span class="na">unit=</span><span class="s">&#39;GiB&#39;</span><span class="nt">&gt;</span>6<span class="nt">&lt;/memory&gt;</span>
  <span class="nt">&lt;vcpu&gt;</span>4<span class="nt">&lt;/vcpu&gt;</span>
  <span class="nt">&lt;os&gt;</span>
    <span class="nt">&lt;type&gt;</span>hvm<span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;boot</span> <span class="na">dev=</span><span class="s">&#39;network&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;boot</span> <span class="na">dev=</span><span class="s">&#39;hd&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;bios</span> <span class="na">useserial=</span><span class="s">&#39;yes&#39;</span> <span class="na">rebootTimeout=</span><span class="s">&#39;0&#39;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/os&gt;</span>
  <span class="nt">&lt;features&gt;</span>
    <span class="nt">&lt;acpi/&gt;</span>
    <span class="nt">&lt;apic/&gt;</span>
    <span class="nt">&lt;pae/&gt;</span>
  <span class="nt">&lt;/features&gt;</span>

  <span class="nt">&lt;devices&gt;</span>

    <span class="nt">&lt;emulator&gt;</span>/usr/libexec/qemu-kvm<span class="nt">&lt;/emulator&gt;</span>

    <span class="nt">&lt;disk</span> <span class="na">type=</span><span class="s">&#39;file&#39;</span> <span class="na">device=</span><span class="s">&#39;disk&#39;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;source</span> <span class="na">file=</span><span class="s">&#39;/var/lib/libvirt/images/{{ HOSTNAME }}.dd&#39;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;target</span> <span class="na">dev=</span><span class="s">&#39;vda&#39;</span> <span class="na">bus=</span><span class="s">&#39;virtio&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/disk&gt;</span>

    <span class="nt">&lt;interface</span> <span class="na">type=</span><span class="s">&#39;bridge&#39;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;mac</span> <span class="na">address=</span><span class="s">&#39;{{ MAC_ADDRESS }}&#39;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;source</span> <span class="na">bridge=</span><span class="s">&#39;br0&#39;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;model</span> <span class="na">type=</span><span class="s">&#39;virtio&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/interface&gt;</span>

    <span class="nt">&lt;serial</span> <span class="na">type=</span><span class="s">&#39;pty&#39;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;target</span> <span class="na">port=</span><span class="s">&#39;0&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/serial&gt;</span>
    <span class="nt">&lt;console</span> <span class="na">type=</span><span class="s">&#39;pty&#39;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;target</span> <span class="na">type=</span><span class="s">&#39;serial&#39;</span> <span class="na">port=</span><span class="s">&#39;0&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/console&gt;</span>

    <span class="nt">&lt;graphics</span> <span class="na">type=</span><span class="s">&#39;vnc&#39;</span> <span class="na">autoport=</span><span class="s">&#39;yes&#39;</span> <span class="na">listen=</span><span class="s">&#39;127.0.0.1&#39;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;/devices&gt;</span>
<span class="nt">&lt;/domain&gt;</span>
</pre></div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../koji-policy-writing/" title="Koji Policy Writing" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Koji Policy Writing
              </span>
            </div>
          </a>
        
        
          <a href="../../documentation/writing-documentation/" title="Writing Documentation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Writing Documentation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.9fb73e57.js"></script>
      
      <script>app.initialize({version:"0.17.1",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>